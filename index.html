<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>๐ง NeuroQuest - ุฑุญูุฉ ุงูุฏูุงุบ</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- ุดุงุดุฉ ุงูุจุฏุงูุฉ -->
  <div id="startScreen">
    <h1>๐ง NeuroQuest</h1>
    <p>ูุฑุญุจูุง ุจู ูู ุฑุญูุฉ ุฏุงุฎู ุงูุฏูุงุบ!</p>
    <p>ูุฏูู ูู ุฅุนุงุฏุฉ ุจูุงุก ุงูุฎูุงูุง ุงูุนุตุจูุฉ ูุฅููุงุฐ ุงููุฑูุถ ุฃุญูุฏ.</p>
    <button onclick="startGame()">ุงุจุฏุฃ ุงูุฑุญูุฉ</button>
  </div>

  <!-- ุงููุณู ุงูุฑุฆูุณู ููุนุจุฉ -->
  <div id="gameContainer" style="display: none;">
    <h1 id="levelTitle">๐ง ูุณุชูู 1: ุจูุงุก ุงูุฎููุฉ ุงูุนุตุจูุฉ</h1>
    <div id="progressBar">ุงููุณุชูู: <span id="levelNum">1</span></div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div id="infoBox">ุงุณุญุจ ุงูุฃุฌุฒุงุก ูุถุนูุง ูู ุฃูุงูููุง ุงูุตุญูุญุฉ</div>
    <div id="nextLevelBtn" style="display: none;"><button onclick="nextLevel()">ุงููุณุชูู ุงูุชุงูู</button></div>
  </div>

  <!-- ุดูุงุฏุฉ ุงูุฅุชูุงู -->
  <div id="certificateScreen" style="display: none;">
    <h1>๐ ุดูุงุฏุฉ ุฅูุฌุงุฒ</h1>
    <p>ููุฏ ุฃุชููุช ุฌููุน ูุณุชููุงุช ูุนุจุฉ NeuroQuest!</p>
    <p><strong>๐ง ุฃูุช ุงูุขู ูุงุฏุฑ ุนูู ููู ุชุฑููุจ ุงูุฎููุฉ ุงูุนุตุจูุฉ!</strong></p>
    <p><strong>ุฅุฌูุงูู ุงูููุงุท: <span id="totalScore">0</span></strong></p>
    <button onclick="restartGame()">ุงูุนุจ ูุฑุฉ ุฃุฎุฑู</button>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let currentLevel = 1;
    let score = 0;

    // ุจูุงูุงุช ุงููุณุชููุงุช
    const levels = [
      {
        title: "ูุณุชูู 1: ุจูุงุก ุงูุฎููุฉ ุงูุนุตุจูุฉ",
        parts: [
          { name: "ุฌุณู ุงูุฎููุฉ", x: 400, y: 300, placed: false, correctX: 380, correctY: 280 },
          { name: "ุงููุญูุฑ (Axon)", x: 500, y: 300, placed: false, correctX: 480, correctY: 280 },
          { name: "ุงูุดุฌุฑุฉ ุงูุนุตุจูุฉ", x: 300, y: 300, placed: false, correctX: 280, correctY: 280 }
        ],
        info: {
          "ุฌุณู ุงูุฎููุฉ": "ูู ูุฑูุฒ ุงูุฎููุฉ ููุญุชูู ุนูู ุงูููุงุฉ.",
          "ุงููุญูุฑ (Axon)": "ูููู ุงูุฅุดุงุฑุงุช ูู ุงูุฎููุฉ ุฅูู ุงูุฎูุงูุง ุงูุฃุฎุฑู.",
          "ุงูุดุฌุฑุฉ ุงูุนุตุจูุฉ": "ุชุณุชูุจู ุงูุฅุดุงุฑุงุช ูู ุงูุฎูุงูุง ุงูุนุตุจูุฉ ุงููุฌุงูุฑุฉ."
        }
      },
      {
        title: "ูุณุชูู 2: ุชุฑุชูุจ ุฎุทูุงุช ุงูุฅุดุงุฑุฉ",
        parts: [
          { name: "ุงูุชุญููุฒ", x: 100, y: 200, placed: false, correctX: 100, correctY: 200 },
          { name: "ุงุณุชูุจุงู ุงูุฅุดุงุฑุฉ", x: 200, y: 200, placed: false, correctX: 200, correctY: 200 },
          { name: "ุงูููุงุฉ", x: 300, y: 200, placed: false, correctX: 300, correctY: 200 },
          { name: "ุงููุญูุฑ", x: 400, y: 200, placed: false, correctX: 400, correctY: 200 },
          { name: "ุงูุชุดุงุจู", x: 500, y: 200, placed: false, correctX: 500, correctY: 200 }
        ],
        info: {
          "ุงูุชุญููุฒ": "ูุจุฏุฃ ุงูุชุญููุฒ ุนูุฏ ููุณ ุดูุก ุณุงุฎูุ ูุซู ุงููููุฏ.",
          "ุงุณุชูุจุงู ุงูุฅุดุงุฑุฉ": "ุงูุดุฌุฑุฉ ุงูุนุตุจูุฉ ุชุณุชูุจู ุงูุฅุดุงุฑุฉ ุงูุฃูููุฉ.",
          "ุงูููุงุฉ": "ุงูููุงุฉ ุชูุนุฏู ุงูุฅุดุงุฑุฉ ูุชูุฑุณููุง ุนุจุฑ ุงููุญูุฑ.",
          "ุงููุญูุฑ": "ุงููุญูุฑ ูููู ุงูุฅุดุงุฑุฉ ุจุณุฑุนุฉ ุฅูู ุฎููุฉ ุฃุฎุฑู.",
          "ุงูุชุดุงุจู": "ุงูุชุดุงุจู ูููู ุงูุฅุดุงุฑุฉ ูู ุฎููุฉ ุฅูู ุฃุฎุฑู."
        }
      },
      {
        title: "ูุณุชูู 3: ุชูุตูู ุงูุฎูุงูุง",
        lines: [],
        circles: [
          { x: 100, y: 100, radius: 30, label: "ุฎููุฉ 1", connected: false },
          { x: 300, y: 100, radius: 30, label: "ุฎููุฉ 2", connected: false },
          { x: 500, y: 100, radius: 30, label: "ุฎููุฉ 3", connected: false }
        ],
        explanation: "ูุตู ุจูู ุงูุฎูุงูุง ูุชููู ุดุจูุฉ ุนุตุจูุฉ ูุงููุฉ"
      },
      {
        title: "ูุณุชูู 4: ุงูุชุดุงู ุงูุฌุฒุก ุงููุนุทู",
        parts: [
          { name: "ุฌุณู ุงูุฎููุฉ", x: 400, y: 300, broken: true },
          { name: "ุงููุญูุฑ", x: 500, y: 300, broken: false },
          { name: "ุงูุดุฌุฑุฉ ุงูุนุตุจูุฉ", x: 300, y: 300, broken: false }
        ],
        explanation: "ุงููุฑ ุนูู ุงูุฌุฒุก ุงูุฐู ูุจุฏู ูุนุทูุจูุง"
      },
      {
        title: "ูุณุชูู 5: ุจูุงุก ุฑุฏ ุงููุนู",
        steps: [
          { name: "ุงูุชุญููุฒ", x: 50, y: 100, placed: false },
          { name: "Dendrite", x: 150, y: 100, placed: false },
          { name: "ุงูููุงุฉ", x: 250, y: 100, placed: false },
          { name: "Axon", x: 350, y: 100, placed: false },
          { name: "Synapse", x: 450, y: 100, placed: false }
        ],
        targets: [
          { name: "ุงูุชุญููุฒ", x: 50, y: 200 },
          { name: "Dendrite", x: 150, y: 200 },
          { name: "ุงูููุงุฉ", x: 250, y: 200 },
          { name: "Axon", x: 350, y: 200 },
          { name: "Synapse", x: 450, y: 200 }
        ],
        explanation: "ุงุฑุจุท ูู ุฎุทูุฉ ุจููุถุนูุง ุงูุตุญูุญ ูุฅููุงู ุงูุฏุงุฆุฑุฉ ุงูุนุตุจูุฉ"
      }
    ];

    let draggedItem = null;
    let draggingLine = null;

    function startGame() {
      document.getElementById("startScreen").style.display = "none";
      document.getElementById("gameContainer").style.display = "block";
      document.getElementById("levelTitle").innerText = levels[currentLevel - 1].title;
      document.getElementById("levelNum").innerText = currentLevel;
      draw();
    }

    function nextLevel() {
      if (currentLevel < levels.length) {
        currentLevel++;
        document.getElementById("levelTitle").innerText = levels[currentLevel - 1].title;
        document.getElementById("levelNum").innerText = currentLevel;
        resetLevel();
        document.getElementById("nextLevelBtn").style.display = "none";
        document.getElementById("infoBox").style.display = "block";
        document.getElementById("infoBox").innerText = "ุงุจุฏุฃ ุงููุณุชูู ุงูุฌุฏูุฏ!";
        draw();
      } else {
        showCertificate();
      }
    }

    function showCertificate() {
      document.getElementById("gameContainer").style.display = "none";
      document.getElementById("certificateScreen").style.display = "block";
      document.getElementById("totalScore").innerText = score;
    }

    function restartGame() {
      currentLevel = 1;
      score = 0;
      document.getElementById("certificateScreen").style.display = "none";
      document.getElementById("gameContainer").style.display = "block";
      document.getElementById("levelTitle").innerText = levels[0].title;
      document.getElementById("levelNum").innerText = 1;
      resetLevel();
      draw();
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      const level = levels[currentLevel - 1];

      if (currentLevel === 1) {
        level.parts.forEach(part => {
          drawImageFromURL(part.name, part.x, part.y, 40, part.placed ? "#aaa" : "#007acc");
          ctx.setLineDash([5]);
          ctx.strokeStyle = "#999";
          ctx.strokeRect(part.correctX, part.correctY, 40, 40);
          ctx.setLineDash([]);
        });

        if (level.parts.every(p => p.placed)) {
          document.getElementById("infoBox").innerHTML = `
            ๐ ุชู! ููููู ูุดุงูุฏุฉ ููู ุชุนูู ุงูุฅุดุงุฑุฉ ุงูุนุตุจูุฉ.<br>
            <small>ุงุณุชูุฑ ูู ุงููุนุจ...</small>
          `;
          document.getElementById("nextLevelBtn").style.display = "block";
          score += 10;
        }

      } else if (currentLevel === 2) {
        level.parts.forEach((part, i) => {
          drawImageFromURL(part.name, part.x, part.y, 40, "#007acc");
        });

        if (isOrderedCorrectly()) {
          document.getElementById("infoBox").innerHTML = `โ ุฑุงุฆุน! ููุฏ ุฑุชุจุช ุงูุฎุทูุงุช ุจุดูู ุตุญูุญ.`;
          document.getElementById("nextLevelBtn").style.display = "block";
          score += 10;
        }

      } else if (currentLevel === 3) {
        level.circles.forEach(circle => {
          ctx.beginPath();
          ctx.arc(circle.x, circle.y, circle.radius, 0, Math.PI * 2);
          ctx.fillStyle = circle.connected ? "#007acc" : "#ddd";
          ctx.fill();
          ctx.fillStyle = "#000";
          ctx.textAlign = "center";
          ctx.font = "14px Arial";
          ctx.fillText(circle.label, circle.x, circle.y + 5);
        });

        level.lines.forEach(line => {
          ctx.beginPath();
          ctx.moveTo(line.from.x, line.from.y);
          ctx.lineTo(line.to.x, line.to.y);
          ctx.strokeStyle = "#007acc";
          ctx.stroke();
        });

        if (level.circles.every(c => c.connected)) {
          document.getElementById("infoBox").innerHTML = `โ ุชู! ููุฏ ุจููุช ุดุจูุฉ ุนุตุจูุฉ ูุงููุฉ`;
          document.getElementById("nextLevelBtn").style.display = "block";
          score += 10;
        }

      } else if (currentLevel === 4) {
        level.parts.forEach(part => {
          drawImageFromURL(part.name, part.x, part.y, 40, part.broken ? "red" : "#007acc");
        });
        document.getElementById("infoBox").innerText = "ุงููุฑ ุนูู ุงูุฌุฒุก ุงููุนุทูุจ";

      } else if (currentLevel === 5) {
        level.steps.forEach(step => {
          drawImageFromURL(step.name, step.x, step.y, 40, "#007acc");
        });

        level.targets.forEach(target => {
          ctx.strokeStyle = "#999";
          ctx.strokeRect(target.x, target.y, 40, 40);
        });

        document.getElementById("infoBox").innerText = "ุงุณุญุจ ุงูุฃุฌุฒุงุก ูุถุนูุง ูู ุฃูุงูููุง";
      }
    }

    function isOrderedCorrectly() {
      return levels[1].parts.every((p, i) => p.order === i);
    }

    function resetLevel() {
      const level = levels[currentLevel - 1];
      if (level.parts) level.parts.forEach(p => p.placed = false);
      if (level.circles) level.circles.forEach(c => c.connected = false);
      if (level.steps) level.steps.forEach(s => s.placed = false);
      document.getElementById("nextLevelBtn").style.display = "none";
      document.getElementById("infoBox").style.display = "block";
      document.getElementById("infoBox").innerText = "ุงุจุฏุฃ ุงููุณุชูู!";
      draw();
    }

    function drawImageFromURL(name, x, y, size, color = "#007acc") {
      const img = new Image();
      const imageUrl = {
        "ุฌุณู ุงูุฎููุฉ": "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Neuron.svg/480px-Neuron.svg.png ",
        "ุงููุญูุฑ (Axon)": "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/Gray669.png/800px-Gray669.png ",
        "ุงูุดุฌุฑุฉ ุงูุนุตุจูุฉ": "https://upload.wikimedia.org/wikipedia/commons/thumb/3/37/Dendrite_Development.png/800px-Dendrite_Development.png ",
        "ุงูุบุดุงุก ุงููุงููููู": "https://upload.wikimedia.org/wikipedia/commons/thumb/5/54/Myelination_diagram.svg/1200px-Myelination_diagram.svg.png ",
        "ุงูุชุดุงุจู ุงูุนุตุจู": "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Synapse_Diagram.png/800px-Synapse_Diagram.png "
      }[name] || "";

      if (imageUrl) {
        img.src = imageUrl;
        img.onload = () => {
          ctx.drawImage(img, x, y, size, size);
        };
      } else {
        ctx.fillStyle = color;
        ctx.fillRect(x, y, size, size);
        ctx.fillStyle = "#fff";
        ctx.font = "12px Arial";
        ctx.fillText(name.charAt(0), x + 15, y + 25);
      }
    }

    function connectCircles(clickedCircle) {
      if (!clickedCircle.connected) {
        clickedCircle.connected = true;
        levels[2].lines.push({
          from: { x: clickedCircle.x, y: clickedCircle.y },
          to: { x: clickedCircle.x + 100, y: clickedCircle.y }
        });
      }
    }

    function playSound(id) {
      const sound = document.getElementById(id);
      if (sound) {
        sound.currentTime = 0;
        sound.play();
      }
    }

    canvas.addEventListener("mousedown", e => {
      const rect = canvas.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;

      const level = levels[currentLevel - 1];

      if (currentLevel === 1) {
        level.parts.forEach(part => {
          if (!part.placed &&
              mouseX > part.x && mouseX < part.x + 40 &&
              mouseY > part.y && mouseY < part.y + 40) {
            draggedItem = part;
          }
        });
      } else if (currentLevel === 2) {
        level.parts.forEach(part => {
          if (!part.moved) {
            if (mouseX > part.x && mouseX < part.x + 40 &&
                mouseY > part.y && mouseY < part.y + 40) {
              draggedItem = part;
            }
          }
        });
      } else if (currentLevel === 3) {
        level.circles.forEach(circle => {
          const dx = mouseX - circle.x;
          const dy = mouseY - circle.y;
          if (Math.sqrt(dx * dx + dy * dy) < circle.radius) {
            connectCircles(circle);
          }
        });
      } else if (currentLevel === 4) {
        level.parts.forEach(part => {
          if (mouseX > part.x && mouseX < part.x + 40 &&
              mouseY > part.y && mouseY < part.y + 40) {
            if (part.broken) {
              score += 10;
              alert("โ ูุฐุง ุงูุฌุฒุก ูุงู ูุนุทูุจุงู! ุชูุงูููุง!");
              nextLevel();
            } else {
              alert("โ ูุฐุง ุงูุฌุฒุก ูุนูู ุจุดูู ุตุญูุญ.");
            }
          }
        });
      } else if (currentLevel === 5) {
        level.steps.forEach(step => {
          if (mouseX > step.x && mouseX < step.x + 40 &&
              mouseY > step.y && mouseY < step.y + 40) {
            draggedItem = step;
          }
        });
      }

      draw();
    });

    canvas.addEventListener("mousemove", e => {
      const rect = canvas.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;

      if (draggedItem && currentLevel === 1) {
        draggedItem.x = mouseX - 20;
        draggedItem.y = mouseY - 20;
        checkPlacement(draggedItem);
      } else if (draggedItem && currentLevel === 2) {
        draggedItem.x = mouseX - 20;
        draggedItem.y = mouseY - 20;
      } else if (draggedItem && currentLevel === 5) {
        draggedItem.x = mouseX - 20;
        draggedItem.y = mouseY - 20;
      }

      draw();
    });

    canvas.addEventListener("mouseup", () => {
      const level = levels[currentLevel - 1];

      if (draggedItem && currentLevel === 1) {
        const dx = Math.abs(draggedItem.x - draggedItem.correctX);
        const dy = Math.abs(draggedItem.y - draggedItem.correctY);
        if (dx < 20 && dy < 20) {
          draggedItem.x = draggedItem.correctX;
          draggedItem.y = draggedItem.correctY;
          draggedItem.placed = true;
        }
      } else if (draggedItem && currentLevel === 2) {
        draggedItem.moved = true;
        for (let i = 0; i < level.parts.length; i++) {
          if (draggedItem === level.parts[i]) {
            draggedItem.order = i;
            break;
          }
        }
      } else if (draggedItem && currentLevel === 5) {
        level.targets.forEach(target => {
          const dx = draggedItem.x - target.x;
          const dy = draggedItem.y - target.y;
          if (Math.abs(dx) < 10 && Math.abs(dy) < 10) {
            draggedItem.x = target.x;
            draggedItem.y = target.y;
            draggedItem.placed = true;
          }
        });
      }

      draggedItem = null;
      draw();
    });

    function checkPlacement(part) {
      const dx = Math.abs(part.x - part.correctX);
      const dy = Math.abs(part.y - part.correctY);
      if (dx < 20 && dy < 20) {
        part.x = part.correctX;
        part.y = part.correctY;
        part.placed = true;
        score += 10;
      }
    }

    function isOrderedCorrectly() {
      return levels[1].parts.every((p, i) => p.order === i);
    }

    draw();
  </script>
</body>
</html>
